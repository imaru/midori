<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

        <meta name="author" content="Toshihide Imaruoka" />
    
    
    <title>midori1</title>

        <script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
        <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="site_libs/downcute-0.1/downcute.css" rel="stylesheet" />
        <link href="site_libs/downcute-0.1/downcute_fonts_embed.css" rel="stylesheet" />
        <script src="site_libs/downcute-0.1/downcute_styles.js"></script>
        <script src="site_libs/downcute-0.1/downcute.js"></script>
        <script src="site_libs/prism-1.22/prism.js"></script>
    
    
    
        <link rel="stylesheet" href="mycss.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
               <!-- downcute start -->   
   <div id="docute" class="Root theme-default">
     <div class="Page layout-narrow">
      <div class="Wrap">
        <div class="Sidebar">
          <div class="SidebarItems" id="toc">
            <ul>
            <li><a href="#エピグラフ">エピグラフ</a></li>
            <li><a href="#まえがき">まえがき</a></li>
            <li><a href="#章">1章</a>
            <ul>
            <li><a href="#統計モデルなぜ統計なモデル">1.1 統計モデル：なぜ「統計」な「モデル」？</a></li>
            <li><a href="#ブラックボックスな統計解析の悪夢">1.2 「ブラックボックスな統計解析」の悪夢</a></li>
            <li><a href="#この本の内容一般化線形モデルの導入とそのベイズ的な拡張">1.3 この本の内容：一般化線形モデルの導入とそのベイズ的な拡張</a></li>
            <li><a href="#各章の内容全体の説明の流れ">1.3.1 各章の内容–全体の説明の流れ</a></li>
            <li><a href="#この本に登場する訳語記号記法について">1.4 この本に登場する訳語・記号・記法について</a></li>
            <li><a href="#おまけ">おまけ</a></li>
            </ul></li>
            <li><a href="#章-確率分布と統計モデルの最尤推定">2章: 確率分布と統計モデルの最尤推定</a>
            <ul>
            <li><a href="#例題種子数の統計モデリング">2.1 例題：種子数の統計モデリング</a></li>
            <li><a href="#データと確率分布の対応関係をながめる">2.2 データと確率分布の対応関係をながめる</a></li>
            <li><a href="#ポアソン分布とは何か">2.3 ポアソン分布とは何か？</a></li>
            <li><a href="#ポアソン分布のパラメータの最尤推定">2.4 ポアソン分布のパラメータの最尤推定</a></li>
            <li><a href="#疑似乱数と最尤推定値のばらつき">2.4.1 疑似乱数と最尤推定値のばらつき</a></li>
            </ul></li>
            </ul>
          </div>
          <div data-position="sidebar:post-end" class="InjectedComponents"><div class="dark-theme-toggler"><div class="toggle "><div class="toggle-track"><div class="toggle-track-check"><img  src="data:image/png;base64,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" role="presentation" style="pointer-events: none;" width="16" height="16"></div> <div class="toggle-track-x"><img src="data:image/png;base64,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" role="presentation" style="pointer-events: none;" width="16" height="16"></div></div> <div class="toggle-thumb"></div></div> <input type="checkbox" aria-label="Switch between Dark and Default theme" class="toggler-screen-reader-only"></div></div>
        </div>
        <div class="Main">
          <div class="Content" id="content"> 
   
   
      
      <div class="navbar navbar-default  navbar-fixed-top" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">my public memo</a>
          </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li>
        <a href="index.html">Home</a>
      </li>
      <li>
        <a href="midori1.html">緑本</a>
      </li>
      <li>
        <a href="baba1.html">馬場本1部</a>
      </li>
      <li>
        <a href="baba2.html">馬場本2部</a>
      </li>
      <li>
        <a href="baba3.html">馬場本3部</a>
      </li>
      <li>
        <a href="baba4.html">馬場本4部</a>
      </li>
      <li>
        <a href="psytech.html">技術部</a>
      </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              
            </ul>
          </div><!--/.nav-collapse -->
        </div><!--/.container -->
      </div><!--/.navbar -->
        
      <h1 class="title">midori1</h1>
      
      <p class="authors">
           <span class="glyphicon glyphicon-user"></span> Toshihide Imaruoka
      </p>
              

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div class="page-content has-page-title">
<div id="エピグラフ" class="section level1">
<h1>エピグラフ</h1>
<ul>
<li>赤池弘次先生：モデルの良さの指標で知られるAICで有名。</li>
</ul>
</div>
<div id="まえがき" class="section level1">
<h1>まえがき</h1>
<ul>
<li>「数理モデルで現象を表現・説明する」</li>
<li>一般化線形モデル（GLM: generalized linear model）
<ul>
<li>前半でGLM入門</li>
<li>後半でベイズ統計モデル</li>
</ul></li>
<li>ソフトウェアとサポートWebサイト
<ul>
<li>R</li>
<li>WinBUGS: マルコフ連鎖モンテカルロ（MCMC）法を行うためのソフトウェア
<ul>
<li>MCMC法はR上で動くStanやBRMSというソフトでも計算できる</li>
<li>使う頃になったら、そのあたりは勉強会でも扱いましょう</li>
</ul></li>
<li><a href="https://kuboweb.github.io/-kubo/ce/IwanamiBook.html">サポートWeb</a></li>
</ul></li>
</ul>
</div>
<div id="章" class="section level1">
<h1>1章</h1>
<div id="統計モデルなぜ統計なモデル" class="section level2">
<h2>1.1 統計モデル：なぜ「統計」な「モデル」？</h2>
<ul>
<li>統計モデル（statistical model）とは
<ul>
<li>データとして観測された現象を説明するため</li>
<li>データにあるばらつきを説明するために確率分布を利用</li>
<li>観測データとモデルの当てはまり具合を評価可能</li>
</ul></li>
<li>P3の図
<ul>
<li>情報の（消失と言ってるけど、実際には）要約</li>
<li>自然界で観測できる現象の本質を知るために、なるべくうまく要約したい</li>
<li>そのためには確率分布という部品は不可欠</li>
</ul></li>
</ul>
</div>
<div id="ブラックボックスな統計解析の悪夢" class="section level2">
<h2>1.2 「ブラックボックスな統計解析」の悪夢</h2>
<ul>
<li>悪夢たち＝QRPs(Questionable Research Practices)
<ul>
<li>検定手法の繰り返し：計画していた相関係数の検定では効果が見られなかったから群分けしてt検定してみよう、とか</li>
<li>謎指標の作成：統制条件との差では効果がなかったから比を取る、とか</li>
<li><span class="math inline">\(R^2\)</span>の解釈：重回帰式の<span class="math inline">\(R^2\)</span>が小さいから説明変数を増やしてみよう、とか</li>
<li>データの変数変換：反応時間データは角変換するもの、と習ったような…</li>
<li>ノンパラ：これは具体的な例が浮かばなかった</li>
<li>多重比較：これもそうするもんだって習ったような…</li>
<li>P値：P値と有意水準の比較が全てとは分かっていてもP値が小さいと喜んでしまう…</li>
</ul></li>
</ul>
</div>
<div id="この本の内容一般化線形モデルの導入とそのベイズ的な拡張" class="section level2">
<h2>1.3 この本の内容：一般化線形モデルの導入とそのベイズ的な拡張</h2>
<ul>
<li>一般化線形モデルと「これまでの」統計手法（＝線形モデル）の違い
<ul>
<li>線形モデル：「自然界で観測されるデータは正規分布する」</li>
<li>一般化線形モデル：現象によって分布の種類は異なる
<ul>
<li>2章ではまずはカウントデータから（＝カウントデータは正規分布しない）</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="各章の内容全体の説明の流れ" class="section level2">
<h2>1.3.1 各章の内容–全体の説明の流れ</h2>
<ul>
<li>2章
<ul>
<li>確率分布の説明：例としてポアソン分布（＝カウントデータに使う）</li>
<li>パラメータを推定する：最尤推定</li>
</ul></li>
<li>3章
<ul>
<li>一般化線形モデル
<ul>
<li>ポアソン回帰：ポアソン分布・リンク関数・線形予測子を使ってデータを表現</li>
</ul></li>
</ul></li>
<li>4, 5章
<ul>
<li>モデルの比較：AIC</li>
</ul></li>
<li>5章
<ul>
<li>最大対数尤度</li>
<li>尤度比検定</li>
</ul></li>
<li>6章
<ul>
<li>色々な確率分布を使ったGLM
<ul>
<li>二項分布・ロジスティック回帰：2値データ</li>
<li>正規分布：あまり制約のない連続量データ</li>
<li>ガンマ分布：正の数のみとる連続量データ</li>
</ul></li>
</ul></li>
<li>7章
<ul>
<li>一般化線形混合モデル（GLMM: generalized linear mixed model）
<ul>
<li>統計モデルにランダム効果（＝個人差など）を</li>
</ul></li>
</ul></li>
<li>8章
<ul>
<li>MCMC</li>
<li>ベイズ統計モデル</li>
</ul></li>
<li>9章
<ul>
<li>GLMのベイズモデル化</li>
<li>ソフトウェアを使った推定（WinBUGS）</li>
</ul></li>
<li>10章
<ul>
<li>階層ベイズモデル</li>
</ul></li>
<li>11章
<ul>
<li>階層ベイズモデルの応用：空間構造を考慮した統計モデル</li>
</ul></li>
</ul>
</div>
<div id="この本に登場する訳語記号記法について" class="section level2">
<h2>1.4 この本に登場する訳語・記号・記法について</h2>
<ul>
<li>定まった訳語がないもの
<ul>
<li>逸脱度：deviance</li>
<li>残差逸脱度：residual deviance</li>
<li>固定効果：fixed effects</li>
<li>ランダム効果: random effects</li>
<li>リンク関数：link function</li>
</ul></li>
<li>最近用語が変わりつつあるもの
<ul>
<li>応答変数：response variable
<ul>
<li>従属変数：dependent variable</li>
<li>目的変数という言い方も</li>
</ul></li>
<li>説明変数：explanatory variable
<ul>
<li>独立変数：independent variable</li>
</ul></li>
</ul></li>
<li>式
<ul>
<li>応答変数<span class="math inline">\(y_i\)</span>, 説明変数<span class="math inline">\(\{x_i, f_i\}\)</span>
<ul>
<li><span class="math inline">\(f(y_i)=\beta_1+\beta_2x_i+\beta_3f_i+...\)</span></li>
</ul></li>
<li><span class="math inline">\(f(y_i)\)</span>: 応答変数のリンク関数</li>
<li>右辺：線形予測子</li>
<li><span class="math inline">\(\beta_1\)</span>（説明変数を伴わない）：切片</li>
<li><span class="math inline">\(\beta_2\)</span>（説明変数などを伴う）：傾き</li>
</ul></li>
<li>この本の書き方
<ul>
<li>積の記号（<span class="math inline">\(\times\)</span>）、カッコ（log<span class="math inline">\((x)\)</span>をlog<span class="math inline">\(x\)</span>）を省略（本ではlogと書いてるけど、伊丸岡の資料では<span class="math inline">\(log\)</span>と斜体にします。打ち込むのが面倒という理由）</li>
<li>指数関数：exp<span class="math inline">\(x=e^x\)</span>、<span class="math inline">\(e\)</span>は自然対数の底（である定数）</li>
<li>対数関数：log<span class="math inline">\(x\)</span>はlog<span class="math inline">\(_ex\)</span></li>
<li><span class="math inline">\(i\in\{1,2, ..., 50\}\)</span>：<span class="math inline">\(i\)</span>は個体番号1から50まで</li>
<li>個体を<span class="math inline">\(y_i\)</span>と表すとき、個体を特定せずに指すために<span class="math inline">\(y\)</span>と表記する場合がある</li>
<li><span class="math inline">\(y*\)</span>：<span class="math inline">\(y\)</span>のどれでもいい</li>
<li>和記号（<span class="math inline">\(\sum\)</span>）の下に<span class="math inline">\(i\)</span>（<span class="math inline">\(\sum_i\)</span>）：全ての個体の和</li>
<li>積記号（<span class="math inline">\(\prod\)</span>）の下に<span class="math inline">\(i\)</span>：全ての個体の積</li>
<li>丸めた場合も<span class="math inline">\(\approx\)</span>ではなく等号<span class="math inline">\(=\)</span>を使う</li>
<li><span class="math inline">\(\propto\)</span>は比例</li>
<li><span class="math inline">\(確率変数\sim 確率分布\)</span>：確率変数は確率分布に従う</li>
<li><span class="math inline">\(p(A,B)\)</span>：同時確率（AとBがどちらも生起する確率）</li>
<li><span class="math inline">\(p(A|B)\)</span>：条件付き確率（Bが起きたという条件のもとでAが起きる確率）</li>
<li>集合、ベクトル、行列を太字表記するというルールもあるが、この本では従わない。ただし　例外もあり。</li>
</ul></li>
</ul>
</div>
<div id="おまけ" class="section level2">
<h2>おまけ</h2>
<ul>
<li>資料作りについて
<ul>
<li>この本の特徴
<ul>
<li>数式を表現する機会が多い</li>
<li>図を表現する機会も多い</li>
<li>Rのコードが出てくることも結構ある</li>
</ul></li>
<li>これらが簡単にできる方法で資料を作ると楽</li>
<li>いくつかの選択肢
<ul>
<li>伊丸岡の場合
<ul>
<li>RstudioでR Markdown形式で作っている
<ul>
<li><a href="https://medemanabu.net/latex/operators/">TeX記法</a>で数式を書ける</li>
<li>チャンクという機能でRのコードを書き、それを実行して出力もできる(下に例)</li>
</ul></li>
<li>それをhtmlで書き出している</li>
<li>ついでにGitHubで公開している
<ul>
<li><a href="https://kazutan.github.io/HijiyamaR6/rmd_de_github_site.html#/">R Markdown + Githubでモダンな個人Webサイト構築</a></li>
<li><a href="https://imaru.github.io/pubmemo/">imaru public memo</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<pre class="r"><code>m&lt;-0
v&lt;-1
xdat&lt;-seq(-3,3,0.01)
ydat&lt;-(1/sqrt(2*pi*v))*exp(-(xdat-m)^2/(2*v))
plot(xdat, ydat, type=&#39;l&#39;)</code></pre>
<p><img src="midori1_files/figure-html/unnamed-chunk-1-1.png" width="768" /></p>
</div>
</div>
<div id="章-確率分布と統計モデルの最尤推定" class="section level1">
<h1>2章: 確率分布と統計モデルの最尤推定</h1>
<div id="例題種子数の統計モデリング" class="section level2">
<h2>2.1 例題：種子数の統計モデリング</h2>
<ul>
<li>対象の植物<span class="math inline">\(i\)</span>, 種子数<span class="math inline">\(y_i\)</span></li>
<li>50個の種子数を数える</li>
</ul>
</div>
<div id="データと確率分布の対応関係をながめる" class="section level2">
<h2>2.2 データと確率分布の対応関係をながめる</h2>
<ul>
<li>カウントデータ(=非負の整数)</li>
</ul>
<pre class="r"><code>load(&#39;kubobook_2012-2/distribution/data.RData&#39;)
length(data)</code></pre>
<pre><code>## [1] 50</code></pre>
<pre class="r"><code>summary(data)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    0.00    2.00    3.00    3.56    4.75    7.00</code></pre>
<pre class="r"><code>table(data)</code></pre>
<pre><code>## data
##  0  1  2  3  4  5  6  7 
##  1  3 11 12 10  5  4  4</code></pre>
<pre class="r"><code>hist(data, breaks=seq(-0.5, 9.5, 1))</code></pre>
<p><img src="midori1_files/figure-html/unnamed-chunk-3-1.png" width="768" /></p>
<pre class="r"><code>var(data)</code></pre>
<pre><code>## [1] 2.986122</code></pre>
<pre class="r"><code>sd(data)</code></pre>
<pre><code>## [1] 1.72804</code></pre>
<pre class="r"><code>sqrt(var(data))</code></pre>
<pre><code>## [1] 1.72804</code></pre>
<ul>
<li>この種のデータはポアソン分布という確率分布が便利（カウントデータだから）</li>
<li>確率分布：確率変数の値とその出現確率の対応</li>
<li>ポアソン分布
<ul>
<li>パラメータはひとつ（分布の平均）</li>
<li>今回のデータでは平均3.56</li>
<li>平均3.56のポアソン分布とは?</li>
</ul></li>
</ul>
<pre class="r"><code>y&lt;-0:9
prob&lt;-dpois(y, lambda=3.56)
plot(y, prob, type=&#39;b&#39;, lty=2)</code></pre>
<p><img src="midori1_files/figure-html/unnamed-chunk-4-1.png" width="768" /></p>
<pre class="r"><code>hist(data, breaks=seq(-0.5, 9.5, 1), xlim=c(0,9), ylim=c(0,12))
par(new=T)
plot(y, prob*50, type=&#39;b&#39;, lty=2, xlim=c(0,9), ylim=c(0,12))</code></pre>
<p><img src="midori1_files/figure-html/unnamed-chunk-4-2.png" width="768" /></p>
</div>
<div id="ポアソン分布とは何か" class="section level2">
<h2>2.3 ポアソン分布とは何か？</h2>
<ul>
<li>ポアソン分布
<ul>
<li><span class="math inline">\(p(y|\lambda) = \frac{\lambda^y exp(-\lambda)}{y!}\)</span></li>
<li><span class="math inline">\(y\in \{0, 1, 2, ..., \infty \}\)</span>のとき、全ての<span class="math inline">\(y\)</span>について和をとると1
<ul>
<li><span class="math inline">\(\Sigma^\infty_{y=0} p(y|\lambda)=1\)</span></li>
</ul></li>
<li>確率分布の平均は<span class="math inline">\(\lambda\)</span>、分散も<span class="math inline">\(\lambda\)</span></li>
<li>ポアソン分布を選んだ理由
<ol style="list-style-type: decimal">
<li>値<span class="math inline">\(y_i\)</span>が非負の整数</li>
<li><span class="math inline">\(y_i\)</span>に下限0はあるが、上限は分からない</li>
<li>平均と分散がだいたい同じ</li>
</ol></li>
</ul></li>
</ul>
</div>
<div id="ポアソン分布のパラメータの最尤推定" class="section level2">
<h2>2.4 ポアソン分布のパラメータの最尤推定</h2>
<ul>
<li>観測値に基づいてパラメータ<span class="math inline">\(\lambda\)</span>を推定する</li>
<li>最尤法を使う</li>
<li>データの表記法
<ul>
<li>50個のデータをまとめて表記：<span class="math inline">\(\{y_i\}\)</span>, あるいは <span class="math inline">\(Y=\{y_i\}\)</span>$</li>
<li><span class="math inline">\(p(y_i|\lambda)\)</span>：パラメータ<span class="math inline">\(\lambda\)</span>のときにyが<span class="math inline">\(y_i\)</span>である確率</li>
</ul></li>
<li>尤度：ある<span class="math inline">\(\lambda\)</span>のときに全ての個体<span class="math inline">\(i\)</span>についての<span class="math inline">\(p(y_i|\lambda)\)</span>の積</li>
<li>データが50個のデータセットがあるとき、尤度は下の式
<ul>
<li><span class="math inline">\(L(\lambda)=p(y_1|\lambda)\times p(y_2|\lambda)\times p(y_3|\lambda) ... \times p(y_{50}|\lambda)\)</span></li>
<li><span class="math inline">\(=\Pi_ip(y_i|\lambda)=\Pi_i\frac{\lambda^{y_i}exp(-\lambda)}{y_i!}\)</span></li>
<li>例えば<span class="math inline">\(\lambda=2.0\)</span>を変えていったときの計算は以下の感じ</li>
</ul></li>
</ul>
<pre class="r"><code>i&lt;-0
logL&lt;-array()
pm&lt;-array()
for (lmd in seq(2.0, 5.2, 0.1)){
  logL[i]&lt;-log(prod((lmd^data*exp(-lmd))/gamma(data+1)))
  pm[i]&lt;-lmd
  i&lt;-i+1
}
plot(pm, logL, type=&#39;l&#39;)</code></pre>
<p><img src="midori1_files/figure-html/unnamed-chunk-5-1.png" width="768" /></p>
<ul>
<li>上のやつはかなり不細工。緑本ではfunctionを使ってる
<ul>
<li>logL2 &lt;- function(m) sum(dpois(data, m, log=TRUE))</li>
<li>この意味はmを引数としてdpois(x,m)を計算するということ。mがラムダ。その計算自体をlogL2に代入しているので、sapply関数でパラメータlamdaをlogLに適用することで、計算可能になっている。</li>
</ul></li>
<li>さらに緑本は偏微分を行う
<ul>
<li>複数の変数を持つ式で、ある変数について偏微分するというのは、その変数について微分するということ。</li>
<li>p25の<span class="math inline">\(L(\lambda)\)</span>の式を<span class="math inline">\(\lambda\)</span>について微分するとp26の<span class="math inline">\(logL(\lambda)\)</span>の式になる。</li>
<li>それを偏微分するとp27の式になり、計算すると平均と等しくなるよね、ということ。</li>
<li>ただ、このように傾きが0になるところを探すということで最尤推定できることは普通ないので、コンピュータで最尤推定することになる</li>
</ul></li>
</ul>
</div>
<div id="疑似乱数と最尤推定値のばらつき" class="section level2">
<h2>2.4.1 疑似乱数と最尤推定値のばらつき</h2>
<ul>
<li>今使ってる仮想データはポアソン分布に従う乱数を発生する関数rpois()を使っている。そのときのパラメータは3.5。</li>
<li>rpois()が作るのは乱数なので（ポアソン分布には従っている）、発生する度に仮想データは変わる
<ul>
<li>つまり、前のところで算出した最尤推定値も異なる</li>
<li>この最尤推定値はどのくらいバラつくのか＝標準誤差
<ul>
<li>標準誤差：標本からの推定値（標本の代表値）のばらつき</li>
<li>緑本ではパラメータ3.5で50データを生成というのを3000回繰り返して、ばらつき具体をみている</li>
<li>これは真のモデル（パラメータ3.5のポアソン分布）に基づく確認</li>
<li>通常は観測データから推測された<span class="math inline">\(\hat{\lambda}\)</span>を使って見積もるしかない</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</div>

   
   
              </div>
  </div>
  </div>
  </div>
   
      

  <script>
    $(document).ready(function () {

		// add bootstrap table styles to pandoc tables
	$('tr.header').parent('thead').parent('table').addClass('table table-condensed');
		
 		
	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
